<%@ CodePage="65001" Language="vbscript"%>
<!-- #include virtual = "/myoffice/common/db_connect.inc" -->
<%
t_login_id	= Request("t_id")
t_map		= Request("t_map")
init_login	= Request("init_id")

sql = "select userid from dist where login_id = '" & t_login_id & "' "
Set rs_id = DBConn.Execute(sql)
	t_id = rs_id("userid")
rs_id.Close

sql = "select userid from dist where login_id = '" & init_login & "' "
Set rs_id = DBConn.Execute(sql)
	init_id = rs_id("userid")
rs_id.Close


sql =		"select	*																"
sql = sql & "  from	(																"
sql = sql & "		select	LEVEL-1, a.userid, a.lv, a.login_id						"
sql = sql & "		  from	dist a													"
sql = sql & "		 where	LEVEL-1 = 1												"
sql = sql & "		 start with userid = '" & t_id & "'								"
sql = sql & "		 connect by userid = prior " & t_map & "_id						"
sql = sql & "		)																"
sql = sql & " where	lv >= (select lv from dist where userid = '" & init_id & "')	"
Set rs = DBConn.Execute(sql)

If rs.Eof Then
	Response.Write "F"
Else
	Response.Write rs("login_id")
End If
%>

<!-- #include virtual = "/myoffice/inc/head.html" -->
<script>
$(document).ready(function() {
	$("form[name=login_frm]").find("input").keypress(function(e) {
		if (e.keyCode == 13) {
			$("#btn_send").trigger("click");
		}
	});
});

$('#exp_id').on("blur keyup", function() {
	$(this).val( $(this).val().replace( /[ㄱ-ㅎ|ㅏ-ㅣ|가-힣]/g, '' ) );
});

$('#login_id').on("blur keyup", function() {
	$(this).val( $(this).val().replace( /[ㄱ-ㅎ|ㅏ-ㅣ|가-힣]/g, '' ) );
});

jQuery.fn.validation = function(){
	var fn_chek = false;
	if(this[0].tagName && this[0].tagName.toUpperCase() == "FORM" ) {
		var obj = $(this).find(":input");
		$.each(obj, function(index, value){
			var field_check = $(value).attr("check");
			var field_type	= $(value).attr("check_type");
			var field_length= $(value).attr("check_length");
			var field_key	= $(value).attr("check_key");
			var	field_alert	= $(value).attr("title");
			var field_value	= $(value).val();
			if (field_check == "T") {
				if (value.type == "checkbox"){
					field_key = (field_key) ? Number(field_key) : 1;
					if ($("input:checkbox[name=" + value.name + "]:checked").length < field_key){
						//alert(field_alert);
						$("#login_result").text(field_alert);
						$(value).focus();
						fn_chek = false;
						return false;
					}
				} else if (value.type == "radio"){
					if ($("input:radio[name=" + value.name + "]:checked").length < 1){
						//alert(field_alert);
						$("#login_result").text(field_alert);
						$(value).focus();
						fn_chek = false;
						return false;
					}
				} else if (field_type == "length") {
					if (field_value.length <= Number(field_length))	{
						//alert(field_alert);
						$("#login_result").text(field_alert);
						$(value).focus();
						fn_chek = false;
						return false;
					}
				} else if (field_type == "value") {
					if (field_value != field_key)
					{
						//alert(field_alert);
						$("#login_result").text(field_alert);
						$(value).focus();
						fn_chek = false;
						return false;
					}
				}
			}
			fn_chek = true;
		});
		return fn_chek;
	}
}

jQuery.fn.serializeObject = function() {
	var obj = null;
	try {
		// this[0].tagName이 form tag일 경우
		if(this[0].tagName && this[0].tagName.toUpperCase() == "FORM" ) {
			var arr = this.serializeArray();
			if(arr){
				obj = {};
				jQuery.each(arr, function() {
					// obj의 key값은 arr의 name, obj의 value는 value값

					switch(this.name) {
						case "wallet":
						case "wallet_code":
							if (obj[this.name]){
								obj[this.name] += "," + this.value;
							}else{
								obj[this.name] = this.value;
							}
							break;
						default:
							obj[this.name] = this.value;
					}
				});
			}
		}
	}catch(e) {
		alert(e.message);
	}finally  {}

	return obj;
};
</script>
<style>
	#wrap {
		height:100%;
	}
</style>
<%
Session.CodePage = "65001" : Response.CharSet = "utf-8"
If Session("login_id") <> "" Then
	Response.Redirect "./main.html"
End If
%>
<div class="loginContainer">
	<form class="loginForm" name="login_frm" id="login_frm">
		<div class="loginContentBox">
			<div class="loginLogoBox">
				<img src="/myoffice/img/login/logo_login.png" alt="JINGLOBAL">
			</div>
			<div class="loginUsernamBox">
				<input	type="text" name="login_id" id="login_id" placeholder="Login ID"
						check="T" check_type="length" check_length="2" check_key=""
						title="Login ID required" />
			</div>
			<div class="loginPasswordBox">
				<input	type="password" name="login_pw" id="login_pw" placeholder="Password"
						check="T" check_type="length" check_length="2" check_key=""
						title="Login Password required"/>
			</div>
			<div class="loginResultBox">
				<p id="login_result" class="login_result"></p>
			</div>
			<div class="loginBtnBox">
				<button type="button" id="btn_send">Login</button>
			</div>
			<div class="loginJoinBox">
				<button type="button" onclick="window.location.href='/myoffice/signup.html'">Signup</button>
			</div>
			<!--
			<div class="loginFindBox">
				<button type="button"><i class="fa fa-search" aria-hidden="true"></i> Find ID Password</button>
			</div>
			-->
		</div>
	</form>
</div>
<script>
$("#btn_send").on("click", function(){
	var proc_ok = "T";

	if (!$("#login_frm").validation()){
		proc_ok = "F";
		return false;
	}

	if (proc_ok == "T")	{

		var ajax_url = "/myoffice/common/login_chk.html?login_id=" + $("#login_id").val() + "&login_pw=" + encodeURI($("#login_pw").val());

		$.ajax(ajax_url, {
			success:function(data) {

				arrResult = data.split("|");

				if (arrResult[0] == "SUCCESS") {
					$("#login_result").text(arrResult[1]);
					location.href = "/myoffice/main.html";
				} else {
					$("#login_result").text(arrResult[1]);
				}
			}
		});
	}
});
</script>
<!-- #include virtual = "/myoffice/inc/footer.html" -->